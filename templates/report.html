<!DOCTYPE html>
<html>
<head>
    <title>Weekly Report</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container mt-5">
    <h2>Weekly Time Report</h2>
    <canvas id="weekly-chart" width="400" height="200"></canvas>
    <a href="/weekly-download" class="btn btn-success mt-3">Download Weekly CSV</a>
    <a href="/" class="btn btn-secondary mt-3">Back to Log</a>
</div>
<script>
fetch('/weekly-data').then(res => res.json()).then(data => {
    const ctx = document.getElementById('weekly-chart').getContext('2d');
    const labels = data.weeks;
    const datasets = data.names.map((n, i) => ({
        label: n,
        data: data.hours[n],
        backgroundColor: `hsl(${i * 60},70%,60%)`
    }));
    new Chart(ctx, {
        type: 'bar',
        data: { labels: labels, datasets: datasets },
        options: {
            responsive: true,
            plugins: { title: { display: true, text: 'Weekly Time Tracked' } },
            scales: { x: { stacked: true }, y: { stacked: true } }
        }
    });
});
</script>
</body>
</html>
